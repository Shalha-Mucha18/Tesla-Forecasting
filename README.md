# Tesla Stock Price Forecasting

This project uses historical stock data from Tesla to **predict the next day's closing price**. It compares multiple forecasting techniques and includes exploratory data analysis (EDA), feature engineering, model training, and evaluation. The project provides insights into what methods perform best under different market conditions.

## Project Objective

- Predict the **next day's closing price** of Tesla using historical stock data.
- Compare the performance of multiple time-series models.
- Evaluate model performance using MSE, RMSE, and MAE metrics.
- Present clear data visualizations to support findings.
- Analyze the accuracy and stability of each forecasting method.


## Features

**Data Loading & Preprocessing**

- **Data Ingestion**:  
  The dataset is loaded from a CSV file containing Tesla’s historical stock prices.

- **Target Creation**:  
  A `Target` column is generated by shifting the `Close` price by one day to enable next-day price prediction.

- **Data Cleaning**:
  - Missing values caused by shifting are removed.
  - Unnecessary columns like `Unnamed: 0` are dropped.
  - The `Date` column is converted to datetime and set as the index.

- **Train-Test Split**:  
  - Data is split into training and testing sets based on a configurable ratio (default 80/20).
  - The training set can be extended with a tail of recent data to enhance sequence model performance.

- **ML Preprocessing**:
  - Features and target columns are scaled separately using `MinMaxScaler`.
  - Scaled data is returned for model training and evaluation.

- **LSTM Preprocessing**:
  - Time-step sequences are created from the scaled data.
  - Data is further split into training and validation sets (10 splits).
  - Returns LSTM-ready sequences and the scalers for inverse transformation.

**Feature Engineering**

- **Monthly Return**:  
  - Calculates monthly percentage change in closing price to capture long-term trends.

- **Moving Averages**:  
  - Adds 5, 10, and 20-day averages to smooth short-term price fluctuations.

- **Volatility Measures**:  
  -  Computes five and 10-day rolling standard deviation to measure short-term risk.
   
**Exploratory Data Analysis (EDA)**
- **Moving Averages Visualization** (`plot_moving_averages`)
- **Trend/Residual Decomposition** (`decompose_and_plot`)
- **Volatility Analysis** (`plot_volatility_analysis`)
- **Correlation Heatmap** (`plot_correlation_matrix`)
- **Price & Volume Heatmap** (`plot_price_volume_heatmap`)
- **Outlier Detection** (`plot_outlier_boxplots`)
- **Feature Importance via Random Forest** (`plot_feature_importance`)

**Model Implementations**

- **Classical ML Models:**
  -  Linear Regression
  - Random Forest
  - Decision Tree

- **Deep Learning Models:**
  - LSTM (Long Short-Term Memory)
  - TCN (Temporal Convolutional Network) – LSTM + 1D CNN

- **Time Series Forecasting:**
   - Facebook Prophet
     
**Model Evaluation**

 - **Metrics: MAE, MSE, RMSE, R²**
   
**Testing**

 - **Unit tests for data preprocessing, training model, and evaluation modules using pytest**

**Model Inference**  

  - **load saved models (.pkl and .keras) and verify their structures**

##  Project Structure  
├── **Data/** → `raw/`, `processed/`, `external/`   
├── **src/** → Source code  
│   ├── **data/** → `load_data.py`, `preprocess.py`  
│   ├── **features/** → `build_features.py`  
│   ├── **models/** → `train_model.py`, `evaluate_model.py`  
│   ├── **visualization/** → `visualize.py`  
│   └── **utils/** → `helper_functions.py`  
├── **tests/** → Test scripts  
├── `.gitignore` → Ignore unnecessary files  
├── `README.md` → Project overview  
├── `requirements.txt` → Dependencies  
└── `main.ipynb` → Main Notebook

## Installation

### Prerequisites
- Python 3.8 or higher
- pip package manager
### Setup Instructions

1. **Clone the repository**:
   ```bash
   git clone https://github.com/Shalha-Mucha18/Tesla-Forecasting
   cd Tesla-Forecasting
   ````
2. **Install dependencies**
   ````bash
   pip install -r requirements.txt
   ````
## Testing

**Running Tests**

- Execute all unit and integration tests with:
```bash
pytest
````

## Acknowledgments
- Data sourced from public Tesla stock price datasets.
- Utilises open-source Python libraries including TensorFlow, scikit-learn, Prophet, and Plotly.








